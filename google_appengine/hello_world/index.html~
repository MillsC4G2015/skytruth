<!DOCTYPE html>
<!--
An example web page that creates and displays a custom Google Maps API Map Type
for Earth Engine map tiles.  See Google Maps documentation on Custom Map Types
for details.
-->
<html>
  <head>
    <title>Image List</title>
    <script type="text/javascript"
      src="https://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript">
      /**
      * This page will be called from a Python script in App Engine that uses
      * Jinja templates to pass information from the script to the web page.
      * Here we get the mapid and token for the map tiles that were generated
      * by Earth Engine using the Python script ee_appengine.py.
      */
// var
      var TEST = "{{ myList }}";
    //var TEST1 = "{{ myBigString8 }}";
      var TOKEN = "{{ token }}";
// parse through list using jinja (google search jinja iterate list)
      /**
      * The Google Maps API calls getTileUrl when it tries to display a maps
      * tile.  This is a good place to swap in the mapid and token we got from
      * the Python script. The other values describe other properties of the
      * custom map type.
      */
      var eeMapOptions = {
        getTileUrl: function(tile, zoom) {
          var url = ['https://earthengine.googleapis.com/map',
                     MAPID, zoom, tile.x, tile.y].join("/");
          url += '?token=' + TOKEN
          return url;
        },
        tileSize: new google.maps.Size(256, 256)
      };

      var x1 = prompt("Please enter first coordinate of polygon");
      var x2 = prompt("Please enter second coordinate of polygon");
      var x3 = prompt("Please enter third coordinate of polygon");
      var x4 = prompt("Please enter fourth coordinate of polygon");
      var x5 = prompt("Please enter fifth coordinate of polygon");
      var x6 = prompt("Please enter sixth coordinate of polygon");
      var x7 = prompt("Please enter seventh coordinate of polygon");
      var x8 = prompt("Please enter eighth coordinate of polygon");
      var date1 = prompt("Please enter starting date in format yyyy-mm-dd");
      var date2 = prompt("Please enter ending date in format yyyy-mm-dd");

      var imageCollection = ee.ImageCollection("LANDSAT/LE7");
      var geometry = /* color: d63000 */ee.Geometry.Polygon(
		[[[x1, y1],
		  [x2, y2],
		  [x3, y3],
		  [x4, y4]]]);
      var myCollection = imageCollection.filterBounds(geometry).filterDate(date1, date2); 
      var coll = myCollection.getInfo().features;
      for (var i = 0; i < coll.length; i++){
      	print(coll[i].id);
      }

      // Create the map type.
      var mapType = new google.maps.ImageMapType(eeMapOptions);

      // Initialize the Google Map and add our custom layer overlay.
      function initialize() {  
	var myLatLng = new google.maps.LatLng(41.000, -77.500);
        var mapOptions = {
          center: myLatLng,
          zoom: 8,
          maxZoom: 10,
          streetViewControl: false
        };

        var map = new google.maps.Map(document.getElementById("map"),
                                      mapOptions);
        //map.overlayMapTypes.push(mapType);
      }

     function test() {
	document.write(TEST);
	var x1 = prompt("Please enter first coordinate of polygon");
        var x2 = prompt("Please enter second coordinate of polygon");
        var x3 = prompt("Please enter third coordinate of polygon");
        var x4 = prompt("Please enter fourth coordinate of polygon");
        var x5 = prompt("Please enter fifth coordinate of polygon");
        var x6 = prompt("Please enter sixth coordinate of polygon");
        var x7 = prompt("Please enter seventh coordinate of polygon");
        var x8 = prompt("Please enter eighth coordinate of polygon");
        var date1 = prompt("Please enter starting date in format yyyy-mm-dd");
        var date2 = prompt("Please enter ending date in format yyyy-mm-dd");

        var imageCollection = ee.ImageCollection("LANDSAT/LE7");
        var geometry = /* color: d63000 */ee.Geometry.Polygon(
		[[[x1, y1],
		  [x2, y2],
		  [x3, y3],
		  [x4, y4]]]);
        var myCollection = imageCollection.filterBounds(geometry).filterDate(date1, date2); 
        var coll = myCollection.getInfo().features;
	for (var i = 0; i < coll.length; i++){
      		addToMap(ee.Image(coll[i].id));
     	}
     }

	/*document.writeln("<br>");
	document.write(TEST1);*/
      
     function prompter() {
     	var reply = prompt("Hey there, good looking stranger!  What's your name?", "");
     	var alert = ( "Nice to see you around these parts " + reply + "!");
     }
     
      window.onload = test;
    </script>
  </head>
  <body>
    <div id="test" style="width: 640px; height: 0px;"></div>
    <<ul>
    {% for item in myList -%}
       {{ item }}
    {%- endfor %}
    </ul>
    <!--<input type="button" onclick="prompter()" value="Say my name!">-->
  </body>
</html>
